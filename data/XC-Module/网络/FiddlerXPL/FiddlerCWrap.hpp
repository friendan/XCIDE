namespace FiddlerCWrap {
    struct WrapBytes {
        const uint8_t* p;
        ptrdiff_t len;
    };
    enum class WrapStrEncoding : int {
        ANSI,
        UTF16,
    };

    using WrapBool = int;
    using WrapStrPtr = const TCHAR*;
    using WrapBytesPtr = const WrapBytes*;

    static WrapBool (WINAPI * Fiddler_Application_Init)() = nullptr;
    static WrapBool (WINAPI * Fiddler_Application_Startup)(void* hStartupSettings) = nullptr;
    static void (WINAPI * Fiddler_Application_Shutdown)() = nullptr;
    static WrapBool (WINAPI * Fiddler_Application_RootCertificate_Install)(void* pWrapBytes, WrapStrPtr pPassword) = nullptr;
    static WrapBool (WINAPI * Fiddler_Application_RootCertificate_InstallDefault)() = nullptr;
    static void (WINAPI * Fiddler_Application_EnableSessionsMutex)(WrapBool v) = nullptr;
    static void (WINAPI * Fiddler_Application_Attach_OnRequestHeadersAvailable)(void* pCallback, void* arg1, void* arg2) = nullptr;
    static void (WINAPI * Fiddler_Application_Attach_OnResponseHeadersAvailable)(void* pCallback, void* arg1, void* arg2) = nullptr;
    static void (WINAPI * Fiddler_Application_Attach_OnBeforeRequest)(void* pCallback, void* arg1, void* arg2) = nullptr;
    static void (WINAPI * Fiddler_Application_Attach_OnBeforeResponse)(void* pCallback, void* arg1, void* arg2) = nullptr;
    static void (WINAPI * Fiddler_Application_Attach_OnBeforeReturningError)(void* pCallback, void* arg1, void* arg2) = nullptr;
    static void (WINAPI * Fiddler_Application_Attach_OnWebSocketMessage)(void* pCallback, void* arg1, void* arg2) = nullptr;
    static void (WINAPI * Fiddler_Application_WrapManage_Free)() = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Application_Get_VersionString)() = nullptr;
    static WrapBool (WINAPI * Fiddler_Application_IsStarted)() = nullptr;
    static WrapBool (WINAPI * Fiddler_Application_IsSystemProxy)() = nullptr;
    static int (WINAPI * Fiddler_Application_Proxy_Get_ListenPort)() = nullptr;
    static WrapBool (WINAPI * Fiddler_Application_Proxy_Detach)() = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_HTTPHeaders_Get_Item)(void* h, WrapStrPtr name) = nullptr;
    static void (WINAPI * Fiddler_HTTPHeaders_Set_Item)(void* h, WrapStrPtr name, WrapStrPtr value) = nullptr;
    static void (WINAPI * Fiddler_HTTPHeaders_Remove)(void* h, WrapStrPtr name) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_HTTPHeaders_ToString)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_HTTPHeaders_AssignFromString)(void* h, WrapStrPtr value) = nullptr;
    static WrapBool (WINAPI * Fiddler_HTTPHeaders_Exists)(void* h, WrapStrPtr name) = nullptr;
    static WrapBool (WINAPI * Fiddler_HTTPHeaders_ExistsAndContains)(void* h, WrapStrPtr name, WrapStrPtr value) = nullptr;
    static WrapBool (WINAPI * Fiddler_HTTPHeaders_ExistsAndEquals)(void* h, WrapStrPtr name, WrapStrPtr value) = nullptr;
    static WrapBool (WINAPI * Fiddler_HTTPHeaders_RenameHeaderItems)(void* h, WrapStrPtr oldName, WrapStrPtr newName) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_HTTPRequestHeaders_Get_UriScheme)(void* h) = nullptr;
    static void (WINAPI * Fiddler_HTTPRequestHeaders_Set_UriScheme)(void* h, WrapStrPtr uriScheme) = nullptr;
    static void (WINAPI * Fiddler_HTTPResponseHeaders_Set_Status)(void* h, int code, WrapStrPtr pDescription) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Del)(void* h) = nullptr;
    static void* (WINAPI * Fiddler_ProxySettings_New)() = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_UseWebProxyAutoDiscovery)(void* h, WrapBool v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_ProxyAutoConfigEnabled)(void* h, WrapBool v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_ProxyAutoConfigUrl)(void* h, void* v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_BypassHosts)(void* h, WrapStrPtr v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_HttpProxyEnabled)(void* h, WrapBool v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_HttpProxyHost)(void* h, WrapStrPtr v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_HttpProxyPort)(void* h, int v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_HttpsProxyEnabled)(void* h, WrapBool v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_HttpsProxyHost)(void* h, WrapStrPtr v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_HttpsProxyPort)(void* h, int v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_FtpProxyEnabled)(void* h, WrapBool v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_FtpProxyHost)(void* h, WrapStrPtr v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_FtpProxyPort)(void* h, int v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_SocksProxyEnabled)(void* h, WrapBool v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_SocksProxyHost)(void* h, WrapStrPtr v) = nullptr;
    static void (WINAPI * Fiddler_ProxySettings_Set_SocksProxyPort)(void* h, int v) = nullptr;
    static WrapBool (WINAPI * Fiddler_ProxySettings_Get_UseWebProxyAutoDiscovery)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_ProxySettings_Get_ProxyAutoConfigEnabled)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_ProxySettings_Get_ProxyAutoConfigUrl)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_ProxySettings_Get_BypassHosts)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_ProxySettings_Get_HttpProxyEnabled)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_ProxySettings_Get_HttpProxyHost)(void* h) = nullptr;
    static int (WINAPI * Fiddler_ProxySettings_Get_HttpProxyPort)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_ProxySettings_Get_HttpsProxyEnabled)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_ProxySettings_Get_HttpsProxyHost)(void* h) = nullptr;
    static int (WINAPI * Fiddler_ProxySettings_Get_HttpsProxyPort)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_ProxySettings_Get_FtpProxyEnabled)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_ProxySettings_Get_FtpProxyHost)(void* h) = nullptr;
    static int (WINAPI * Fiddler_ProxySettings_Get_FtpProxyPort)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_ProxySettings_Get_SocksProxyEnabled)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_ProxySettings_Get_SocksProxyHost)(void* h) = nullptr;
    static int (WINAPI * Fiddler_ProxySettings_Get_SocksProxyPort)(void* h) = nullptr;
    static void (WINAPI * Fiddler_SessionList_Del)(void* h) = nullptr;
    static void* (WINAPI * Fiddler_SessionList_New)() = nullptr;
    static int (WINAPI * Fiddler_SessionList_Count)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_SessionList_Add)(void* h, void* hSession) = nullptr;
    static WrapBool (WINAPI * Fiddler_SessionList_Clear)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_SessionList_Remove)(void* h, void* hSession) = nullptr;
    static WrapBool (WINAPI * Fiddler_SessionList_RemoveAt)(void* h, int index) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Flags_Get_Item)(void* h, WrapStrPtr pKey) = nullptr;
    static void (WINAPI * Fiddler_Session_Flags_Set_Item)(void* h, WrapStrPtr pKey, WrapStrPtr pValue) = nullptr;
    static void (WINAPI * Fiddler_Session_Flags_Remove)(void* h, WrapStrPtr pKey) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_Flags_ContainsKey)(void* h, WrapStrPtr pKey) = nullptr;
    static void (WINAPI * Fiddler_Session_Flags_Clear)(void* h) = nullptr;
    static int (WINAPI * Fiddler_Session_ID)(void* h) = nullptr;
    static int (WINAPI * Fiddler_Session_Get_BitFlags)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_Get_HasResponse)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_Get_HasWebSocketMessages)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_Get_BufferResponse)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_BufferResponse)(void* h, WrapBool value) = nullptr;
    static void (WINAPI * Fiddler_Session_CreateResponseAndBypassServer)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Ignore)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_Url)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_Url)(void* h, WrapStrPtr pValue) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_FullUrl)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_FullUrl)(void* h, WrapStrPtr pValue) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_Host)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_Host)(void* h, WrapStrPtr pValue) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_HostName)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_HostName)(void* h, WrapStrPtr pValue) = nullptr;
    static int (WINAPI * Fiddler_Session_Get_HostPort)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_HostPort)(void* h, int port) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_HostIP)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_HostIP)(void* h, WrapStrPtr pValue) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_ClientIP)(void* h) = nullptr;
    static int (WINAPI * Fiddler_Session_Get_ClientPort)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_RequestMethod)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_RequestMethod)(void* h, WrapStrPtr pValue) = nullptr;
    static void* (WINAPI * Fiddler_Session_RequestHeaders)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_RequestHeadersString)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_RequestHeadersString)(void* h, WrapStrPtr pValue) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_RequestBodyString)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_RequestBodyString)(void* h, WrapStrPtr pValue) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_DecodeRequest)(void* h) = nullptr;
    static WrapBytesPtr (WINAPI * Fiddler_Session_Get_RequestBody)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_RequestBody)(void* h, WrapBytesPtr pWrapBytes) = nullptr;
    static void* (WINAPI * Fiddler_Session_ResponseHeaders)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_ResponseHeadersString)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_ResponseHeadersString)(void* h, WrapStrPtr pValue) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_ResponseBodyString)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_ResponseBodyString)(void* h, WrapStrPtr pValue) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_DecodeResponse)(void* h) = nullptr;
    static WrapBytesPtr (WINAPI * Fiddler_Session_Get_ResponseBody)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_ResponseBody)(void* h, WrapBytesPtr pWrapBytes) = nullptr;
    static int (WINAPI * Fiddler_Session_Get_ResponseCode)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_ResponseCode)(void* h, int value) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_ToString)(void* h, WrapBool headersOnly) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_RequestBodyEncoding)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_ResponseBodyEncoding)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_LocalProcess)(void* h) = nullptr;
    static int (WINAPI * Fiddler_Session_Get_LocalProcessID)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Session_Get_Flag)(void* h, WrapStrPtr pName) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_Flag)(void* h, WrapStrPtr pName, WrapStrPtr pValue) = nullptr;
    static void* (WINAPI * Fiddler_Session_TunnelAsWebSocket)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_UriContains)(void* h, WrapStrPtr lookfor) = nullptr;
    static void* (WINAPI * Fiddler_Session_Get_Context)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Session_Set_Context)(void* h, void* context) = nullptr;
    static void (WINAPI * Fiddler_Session_Abort)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_ReplaceInRequest)(void* h, WrapStrPtr sSearchFor, WrapStrPtr sReplaceWith) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_ReplaceInResponse)(void* h, WrapStrPtr sSearchFor, WrapStrPtr sReplaceWith) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_ReplaceOnceInResponse)(void* h, WrapStrPtr sSearchFor, WrapStrPtr sReplaceWith, WrapBool bCaseSensitive) = nullptr;
    static WrapBool (WINAPI * Fiddler_Session_ReplaceRegexInResponse)(void* h, WrapStrPtr sSearchForRegEx, WrapStrPtr sReplaceWithExpression) = nullptr;
    static void* (WINAPI * Fiddler_StartupSettingsBuilder_New)() = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_Del)(void* h) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_ListenOnPort)(void* h, int port) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_RegisterAsSystemProxy)(void* h) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_DecryptSSL)(void* h) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_AllowRemoteClients)(void* h) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_ChainToUpstreamGateway)(void* h) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_MonitorAllConnections)(void* h) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_HookUsingPACFile)(void* h) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_CaptureLocalhostTraffic)(void* h) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_CaptureFTP)(void* h) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_OptimizeThreadPool)(void* h) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_SetUpstreamGatewayTo)(void* h, WrapStrPtr upstreamGateway, WrapStrPtr bypassList) = nullptr;
    static void (WINAPI * Fiddler_StartupSettingsBuilder_SetUpstreamProxySettingsTo)(void* h, void* hProxySettingsWrap) = nullptr;
    static void* (WINAPI * Fiddler_StartupSettingsBuilder_Build)(void* h) = nullptr;
    static void (WINAPI * Fiddler_Utilities_Remove_Sec_WebSocket_Extensions_Permessage_Deflate)(void* headersHandle) = nullptr;
    static void (WINAPI * Fiddler_Utilities_WrapManage_Free)() = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_Utilities_ThisAssemblyVersion)() = nullptr;
    static void (WINAPI * Fiddler_Utilities_RecoverMemory)() = nullptr;
    static int (WINAPI * Fiddler_WebSocketMessage_ID)(void* h) = nullptr;
    static void (WINAPI * Fiddler_WebSocketMessage_Abort)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocketMessage_IsOutbound)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocketMessage_IsFinalFrame)(void* h) = nullptr;
    static int (WINAPI * Fiddler_WebSocketMessage_FrameType)(void* h) = nullptr;
    static WrapStrPtr (WINAPI * Fiddler_WebSocketMessage_Get_PayloadString)(void* h) = nullptr;
    static void (WINAPI * Fiddler_WebSocketMessage_Set_PayloadString)(void* h, WrapStrPtr pStr) = nullptr;
    static WrapBytesPtr (WINAPI * Fiddler_WebSocketMessage_Get_Payload)(void* h) = nullptr;
    static void (WINAPI * Fiddler_WebSocketMessage_Set_Payload)(void* h, WrapBytesPtr pWrapBytes) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocket_IsOpen)(void* h) = nullptr;
    static WrapStrEncoding (WINAPI * WrapManage_Get_CurrentWrapStrEncoding)() = nullptr;
    static void (WINAPI * WrapManage_Set_CurrentWrapStrEncoding)(WrapStrEncoding value) = nullptr;
    static void (WINAPI * WrapManage_Set_StringAlloc)(void* callback) = nullptr;
    static void (WINAPI * WrapManage_Set_BytesAlloc)(void* callback) = nullptr;
    static void* (WINAPI * Marshal_Alloc)(int size) = nullptr;
    static void (WINAPI * Marshal_Free)(void* p) = nullptr;
#ifdef ENABLE_FIDDLERCWRAP_EXTEND
    static void (WINAPI * Fiddler_Application_Attach_AfterWebSocketCreateComplete)(void* pCallback, void* arg1, void* arg2) = nullptr;
    static void (WINAPI * Fiddler_Application_Attach_AfterWebSocketCloseComplete)(void* pCallback, void* arg1, void* arg2) = nullptr;
    static void (WINAPI * Fiddler_WebSocketManage_Del)(void* h) = nullptr;
    static void* (WINAPI * Fiddler_WebSocketManage_New)() = nullptr;
    static int (WINAPI * Fiddler_WebSocketManage_RemoveAllClosed)(void* h) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocketManage_SendClientTextMessage)(void* h, WrapStrPtr strPayload) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocketManage_SendClientBinaryMessage)(void* h, WrapBytesPtr wrapBytesPayload) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocketManage_SendServerTextMessage)(void* h, WrapStrPtr strPayload) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocketManage_SendServerBinaryMessage)(void* h, WrapBytesPtr wrapBytesPayload) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocket_SendClientTextMessage)(void* h, WrapStrPtr strPayload) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocket_SendClientBinaryMessage)(void* h, WrapBytesPtr wrapBytesPayload) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocket_SendServerTextMessage)(void* h, WrapStrPtr strPayload) = nullptr;
    static WrapBool (WINAPI * Fiddler_WebSocket_SendServerBinaryMessage)(void* h, WrapBytesPtr wrapBytesPayload) = nullptr;
#endif //ENABLE_FIDDLERCWRAP_EXTEND
    static HMODULE dll_handle_moudle = nullptr;
    static void dll_load(const TCHAR* dllpath) {
        dll_handle_moudle = LoadLibrary(dllpath);
        if (!dll_handle_moudle) {
            throw dllpath;
        }
        auto get_addr = [](auto& addr, const char* procName) {
            addr = reinterpret_cast<std::remove_reference_t<decltype(addr)>>(GetProcAddress(dll_handle_moudle, procName));
            if (!addr) {
                throw procName;
            }
         };
        get_addr(Fiddler_Application_Init, "Fiddler_Application_Init");
        get_addr(Fiddler_Application_Startup, "Fiddler_Application_Startup");
        get_addr(Fiddler_Application_Shutdown, "Fiddler_Application_Shutdown");
        get_addr(Fiddler_Application_RootCertificate_Install, "Fiddler_Application_RootCertificate_Install");
        get_addr(Fiddler_Application_RootCertificate_InstallDefault, "Fiddler_Application_RootCertificate_InstallDefault");
        get_addr(Fiddler_Application_EnableSessionsMutex, "Fiddler_Application_EnableSessionsMutex");
        get_addr(Fiddler_Application_Attach_OnRequestHeadersAvailable, "Fiddler_Application_Attach_OnRequestHeadersAvailable");
        get_addr(Fiddler_Application_Attach_OnResponseHeadersAvailable, "Fiddler_Application_Attach_OnResponseHeadersAvailable");
        get_addr(Fiddler_Application_Attach_OnBeforeRequest, "Fiddler_Application_Attach_OnBeforeRequest");
        get_addr(Fiddler_Application_Attach_OnBeforeResponse, "Fiddler_Application_Attach_OnBeforeResponse");
        get_addr(Fiddler_Application_Attach_OnBeforeReturningError, "Fiddler_Application_Attach_OnBeforeReturningError");
        get_addr(Fiddler_Application_Attach_OnWebSocketMessage, "Fiddler_Application_Attach_OnWebSocketMessage");
        get_addr(Fiddler_Application_WrapManage_Free, "Fiddler_Application_WrapManage_Free");
        get_addr(Fiddler_Application_Get_VersionString, "Fiddler_Application_Get_VersionString");
        get_addr(Fiddler_Application_IsStarted, "Fiddler_Application_IsStarted");
        get_addr(Fiddler_Application_IsSystemProxy, "Fiddler_Application_IsSystemProxy");
        get_addr(Fiddler_Application_Proxy_Get_ListenPort, "Fiddler_Application_Proxy_Get_ListenPort");
        get_addr(Fiddler_Application_Proxy_Detach, "Fiddler_Application_Proxy_Detach");
        get_addr(Fiddler_HTTPHeaders_Get_Item, "Fiddler_HTTPHeaders_Get_Item");
        get_addr(Fiddler_HTTPHeaders_Set_Item, "Fiddler_HTTPHeaders_Set_Item");
        get_addr(Fiddler_HTTPHeaders_Remove, "Fiddler_HTTPHeaders_Remove");
        get_addr(Fiddler_HTTPHeaders_ToString, "Fiddler_HTTPHeaders_ToString");
        get_addr(Fiddler_HTTPHeaders_AssignFromString, "Fiddler_HTTPHeaders_AssignFromString");
        get_addr(Fiddler_HTTPHeaders_Exists, "Fiddler_HTTPHeaders_Exists");
        get_addr(Fiddler_HTTPHeaders_ExistsAndContains, "Fiddler_HTTPHeaders_ExistsAndContains");
        get_addr(Fiddler_HTTPHeaders_ExistsAndEquals, "Fiddler_HTTPHeaders_ExistsAndEquals");
        get_addr(Fiddler_HTTPHeaders_RenameHeaderItems, "Fiddler_HTTPHeaders_RenameHeaderItems");
        get_addr(Fiddler_HTTPRequestHeaders_Get_UriScheme, "Fiddler_HTTPRequestHeaders_Get_UriScheme");
        get_addr(Fiddler_HTTPRequestHeaders_Set_UriScheme, "Fiddler_HTTPRequestHeaders_Set_UriScheme");
        get_addr(Fiddler_HTTPResponseHeaders_Set_Status, "Fiddler_HTTPResponseHeaders_Set_Status");
        get_addr(Fiddler_ProxySettings_Del, "Fiddler_ProxySettings_Del");
        get_addr(Fiddler_ProxySettings_New, "Fiddler_ProxySettings_New");
        get_addr(Fiddler_ProxySettings_Set_UseWebProxyAutoDiscovery, "Fiddler_ProxySettings_Set_UseWebProxyAutoDiscovery");
        get_addr(Fiddler_ProxySettings_Set_ProxyAutoConfigEnabled, "Fiddler_ProxySettings_Set_ProxyAutoConfigEnabled");
        get_addr(Fiddler_ProxySettings_Set_ProxyAutoConfigUrl, "Fiddler_ProxySettings_Set_ProxyAutoConfigUrl");
        get_addr(Fiddler_ProxySettings_Set_BypassHosts, "Fiddler_ProxySettings_Set_BypassHosts");
        get_addr(Fiddler_ProxySettings_Set_HttpProxyEnabled, "Fiddler_ProxySettings_Set_HttpProxyEnabled");
        get_addr(Fiddler_ProxySettings_Set_HttpProxyHost, "Fiddler_ProxySettings_Set_HttpProxyHost");
        get_addr(Fiddler_ProxySettings_Set_HttpProxyPort, "Fiddler_ProxySettings_Set_HttpProxyPort");
        get_addr(Fiddler_ProxySettings_Set_HttpsProxyEnabled, "Fiddler_ProxySettings_Set_HttpsProxyEnabled");
        get_addr(Fiddler_ProxySettings_Set_HttpsProxyHost, "Fiddler_ProxySettings_Set_HttpsProxyHost");
        get_addr(Fiddler_ProxySettings_Set_HttpsProxyPort, "Fiddler_ProxySettings_Set_HttpsProxyPort");
        get_addr(Fiddler_ProxySettings_Set_FtpProxyEnabled, "Fiddler_ProxySettings_Set_FtpProxyEnabled");
        get_addr(Fiddler_ProxySettings_Set_FtpProxyHost, "Fiddler_ProxySettings_Set_FtpProxyHost");
        get_addr(Fiddler_ProxySettings_Set_FtpProxyPort, "Fiddler_ProxySettings_Set_FtpProxyPort");
        get_addr(Fiddler_ProxySettings_Set_SocksProxyEnabled, "Fiddler_ProxySettings_Set_SocksProxyEnabled");
        get_addr(Fiddler_ProxySettings_Set_SocksProxyHost, "Fiddler_ProxySettings_Set_SocksProxyHost");
        get_addr(Fiddler_ProxySettings_Set_SocksProxyPort, "Fiddler_ProxySettings_Set_SocksProxyPort");
        get_addr(Fiddler_ProxySettings_Get_UseWebProxyAutoDiscovery, "Fiddler_ProxySettings_Get_UseWebProxyAutoDiscovery");
        get_addr(Fiddler_ProxySettings_Get_ProxyAutoConfigEnabled, "Fiddler_ProxySettings_Get_ProxyAutoConfigEnabled");
        get_addr(Fiddler_ProxySettings_Get_ProxyAutoConfigUrl, "Fiddler_ProxySettings_Get_ProxyAutoConfigUrl");
        get_addr(Fiddler_ProxySettings_Get_BypassHosts, "Fiddler_ProxySettings_Get_BypassHosts");
        get_addr(Fiddler_ProxySettings_Get_HttpProxyEnabled, "Fiddler_ProxySettings_Get_HttpProxyEnabled");
        get_addr(Fiddler_ProxySettings_Get_HttpProxyHost, "Fiddler_ProxySettings_Get_HttpProxyHost");
        get_addr(Fiddler_ProxySettings_Get_HttpProxyPort, "Fiddler_ProxySettings_Get_HttpProxyPort");
        get_addr(Fiddler_ProxySettings_Get_HttpsProxyEnabled, "Fiddler_ProxySettings_Get_HttpsProxyEnabled");
        get_addr(Fiddler_ProxySettings_Get_HttpsProxyHost, "Fiddler_ProxySettings_Get_HttpsProxyHost");
        get_addr(Fiddler_ProxySettings_Get_HttpsProxyPort, "Fiddler_ProxySettings_Get_HttpsProxyPort");
        get_addr(Fiddler_ProxySettings_Get_FtpProxyEnabled, "Fiddler_ProxySettings_Get_FtpProxyEnabled");
        get_addr(Fiddler_ProxySettings_Get_FtpProxyHost, "Fiddler_ProxySettings_Get_FtpProxyHost");
        get_addr(Fiddler_ProxySettings_Get_FtpProxyPort, "Fiddler_ProxySettings_Get_FtpProxyPort");
        get_addr(Fiddler_ProxySettings_Get_SocksProxyEnabled, "Fiddler_ProxySettings_Get_SocksProxyEnabled");
        get_addr(Fiddler_ProxySettings_Get_SocksProxyHost, "Fiddler_ProxySettings_Get_SocksProxyHost");
        get_addr(Fiddler_ProxySettings_Get_SocksProxyPort, "Fiddler_ProxySettings_Get_SocksProxyPort");
        get_addr(Fiddler_SessionList_Del, "Fiddler_SessionList_Del");
        get_addr(Fiddler_SessionList_New, "Fiddler_SessionList_New");
        get_addr(Fiddler_SessionList_Count, "Fiddler_SessionList_Count");
        get_addr(Fiddler_SessionList_Add, "Fiddler_SessionList_Add");
        get_addr(Fiddler_SessionList_Clear, "Fiddler_SessionList_Clear");
        get_addr(Fiddler_SessionList_Remove, "Fiddler_SessionList_Remove");
        get_addr(Fiddler_SessionList_RemoveAt, "Fiddler_SessionList_RemoveAt");
        get_addr(Fiddler_Session_Flags_Get_Item, "Fiddler_Session_Flags_Get_Item");
        get_addr(Fiddler_Session_Flags_Set_Item, "Fiddler_Session_Flags_Set_Item");
        get_addr(Fiddler_Session_Flags_Remove, "Fiddler_Session_Flags_Remove");
        get_addr(Fiddler_Session_Flags_ContainsKey, "Fiddler_Session_Flags_ContainsKey");
        get_addr(Fiddler_Session_Flags_Clear, "Fiddler_Session_Flags_Clear");
        get_addr(Fiddler_Session_ID, "Fiddler_Session_ID");
        get_addr(Fiddler_Session_Get_BitFlags, "Fiddler_Session_Get_BitFlags");
        get_addr(Fiddler_Session_Get_HasResponse, "Fiddler_Session_Get_HasResponse");
        get_addr(Fiddler_Session_Get_HasWebSocketMessages, "Fiddler_Session_Get_HasWebSocketMessages");
        get_addr(Fiddler_Session_Get_BufferResponse, "Fiddler_Session_Get_BufferResponse");
        get_addr(Fiddler_Session_Set_BufferResponse, "Fiddler_Session_Set_BufferResponse");
        get_addr(Fiddler_Session_CreateResponseAndBypassServer, "Fiddler_Session_CreateResponseAndBypassServer");
        get_addr(Fiddler_Session_Ignore, "Fiddler_Session_Ignore");
        get_addr(Fiddler_Session_Get_Url, "Fiddler_Session_Get_Url");
        get_addr(Fiddler_Session_Set_Url, "Fiddler_Session_Set_Url");
        get_addr(Fiddler_Session_Get_FullUrl, "Fiddler_Session_Get_FullUrl");
        get_addr(Fiddler_Session_Set_FullUrl, "Fiddler_Session_Set_FullUrl");
        get_addr(Fiddler_Session_Get_Host, "Fiddler_Session_Get_Host");
        get_addr(Fiddler_Session_Set_Host, "Fiddler_Session_Set_Host");
        get_addr(Fiddler_Session_Get_HostName, "Fiddler_Session_Get_HostName");
        get_addr(Fiddler_Session_Set_HostName, "Fiddler_Session_Set_HostName");
        get_addr(Fiddler_Session_Get_HostPort, "Fiddler_Session_Get_HostPort");
        get_addr(Fiddler_Session_Set_HostPort, "Fiddler_Session_Set_HostPort");
        get_addr(Fiddler_Session_Get_HostIP, "Fiddler_Session_Get_HostIP");
        get_addr(Fiddler_Session_Set_HostIP, "Fiddler_Session_Set_HostIP");
        get_addr(Fiddler_Session_Get_ClientIP, "Fiddler_Session_Get_ClientIP");
        get_addr(Fiddler_Session_Get_ClientPort, "Fiddler_Session_Get_ClientPort");
        get_addr(Fiddler_Session_Get_RequestMethod, "Fiddler_Session_Get_RequestMethod");
        get_addr(Fiddler_Session_Set_RequestMethod, "Fiddler_Session_Set_RequestMethod");
        get_addr(Fiddler_Session_RequestHeaders, "Fiddler_Session_RequestHeaders");
        get_addr(Fiddler_Session_Get_RequestHeadersString, "Fiddler_Session_Get_RequestHeadersString");
        get_addr(Fiddler_Session_Set_RequestHeadersString, "Fiddler_Session_Set_RequestHeadersString");
        get_addr(Fiddler_Session_Get_RequestBodyString, "Fiddler_Session_Get_RequestBodyString");
        get_addr(Fiddler_Session_Set_RequestBodyString, "Fiddler_Session_Set_RequestBodyString");
        get_addr(Fiddler_Session_DecodeRequest, "Fiddler_Session_DecodeRequest");
        get_addr(Fiddler_Session_Get_RequestBody, "Fiddler_Session_Get_RequestBody");
        get_addr(Fiddler_Session_Set_RequestBody, "Fiddler_Session_Set_RequestBody");
        get_addr(Fiddler_Session_ResponseHeaders, "Fiddler_Session_ResponseHeaders");
        get_addr(Fiddler_Session_Get_ResponseHeadersString, "Fiddler_Session_Get_ResponseHeadersString");
        get_addr(Fiddler_Session_Set_ResponseHeadersString, "Fiddler_Session_Set_ResponseHeadersString");
        get_addr(Fiddler_Session_Get_ResponseBodyString, "Fiddler_Session_Get_ResponseBodyString");
        get_addr(Fiddler_Session_Set_ResponseBodyString, "Fiddler_Session_Set_ResponseBodyString");
        get_addr(Fiddler_Session_DecodeResponse, "Fiddler_Session_DecodeResponse");
        get_addr(Fiddler_Session_Get_ResponseBody, "Fiddler_Session_Get_ResponseBody");
        get_addr(Fiddler_Session_Set_ResponseBody, "Fiddler_Session_Set_ResponseBody");
        get_addr(Fiddler_Session_Get_ResponseCode, "Fiddler_Session_Get_ResponseCode");
        get_addr(Fiddler_Session_Set_ResponseCode, "Fiddler_Session_Set_ResponseCode");
        get_addr(Fiddler_Session_ToString, "Fiddler_Session_ToString");
        get_addr(Fiddler_Session_Get_RequestBodyEncoding, "Fiddler_Session_Get_RequestBodyEncoding");
        get_addr(Fiddler_Session_Get_ResponseBodyEncoding, "Fiddler_Session_Get_ResponseBodyEncoding");
        get_addr(Fiddler_Session_Get_LocalProcess, "Fiddler_Session_Get_LocalProcess");
        get_addr(Fiddler_Session_Get_LocalProcessID, "Fiddler_Session_Get_LocalProcessID");
        get_addr(Fiddler_Session_Get_Flag, "Fiddler_Session_Get_Flag");
        get_addr(Fiddler_Session_Set_Flag, "Fiddler_Session_Set_Flag");
        get_addr(Fiddler_Session_TunnelAsWebSocket, "Fiddler_Session_TunnelAsWebSocket");
        get_addr(Fiddler_Session_UriContains, "Fiddler_Session_UriContains");
        get_addr(Fiddler_Session_Get_Context, "Fiddler_Session_Get_Context");
        get_addr(Fiddler_Session_Set_Context, "Fiddler_Session_Set_Context");
        get_addr(Fiddler_Session_Abort, "Fiddler_Session_Abort");
        get_addr(Fiddler_Session_ReplaceInRequest, "Fiddler_Session_ReplaceInRequest");
        get_addr(Fiddler_Session_ReplaceInResponse, "Fiddler_Session_ReplaceInResponse");
        get_addr(Fiddler_Session_ReplaceOnceInResponse, "Fiddler_Session_ReplaceOnceInResponse");
        get_addr(Fiddler_Session_ReplaceRegexInResponse, "Fiddler_Session_ReplaceRegexInResponse");
        get_addr(Fiddler_StartupSettingsBuilder_New, "Fiddler_StartupSettingsBuilder_New");
        get_addr(Fiddler_StartupSettingsBuilder_Del, "Fiddler_StartupSettingsBuilder_Del");
        get_addr(Fiddler_StartupSettingsBuilder_ListenOnPort, "Fiddler_StartupSettingsBuilder_ListenOnPort");
        get_addr(Fiddler_StartupSettingsBuilder_RegisterAsSystemProxy, "Fiddler_StartupSettingsBuilder_RegisterAsSystemProxy");
        get_addr(Fiddler_StartupSettingsBuilder_DecryptSSL, "Fiddler_StartupSettingsBuilder_DecryptSSL");
        get_addr(Fiddler_StartupSettingsBuilder_AllowRemoteClients, "Fiddler_StartupSettingsBuilder_AllowRemoteClients");
        get_addr(Fiddler_StartupSettingsBuilder_ChainToUpstreamGateway, "Fiddler_StartupSettingsBuilder_ChainToUpstreamGateway");
        get_addr(Fiddler_StartupSettingsBuilder_MonitorAllConnections, "Fiddler_StartupSettingsBuilder_MonitorAllConnections");
        get_addr(Fiddler_StartupSettingsBuilder_HookUsingPACFile, "Fiddler_StartupSettingsBuilder_HookUsingPACFile");
        get_addr(Fiddler_StartupSettingsBuilder_CaptureLocalhostTraffic, "Fiddler_StartupSettingsBuilder_CaptureLocalhostTraffic");
        get_addr(Fiddler_StartupSettingsBuilder_CaptureFTP, "Fiddler_StartupSettingsBuilder_CaptureFTP");
        get_addr(Fiddler_StartupSettingsBuilder_OptimizeThreadPool, "Fiddler_StartupSettingsBuilder_OptimizeThreadPool");
        get_addr(Fiddler_StartupSettingsBuilder_SetUpstreamGatewayTo, "Fiddler_StartupSettingsBuilder_SetUpstreamGatewayTo");
        get_addr(Fiddler_StartupSettingsBuilder_SetUpstreamProxySettingsTo, "Fiddler_StartupSettingsBuilder_SetUpstreamProxySettingsTo");
        get_addr(Fiddler_StartupSettingsBuilder_Build, "Fiddler_StartupSettingsBuilder_Build");
        get_addr(Fiddler_Utilities_Remove_Sec_WebSocket_Extensions_Permessage_Deflate, "Fiddler_Utilities_Remove_Sec_WebSocket_Extensions_Permessage_Deflate");
        get_addr(Fiddler_Utilities_WrapManage_Free, "Fiddler_Utilities_WrapManage_Free");
        get_addr(Fiddler_Utilities_ThisAssemblyVersion, "Fiddler_Utilities_ThisAssemblyVersion");
        get_addr(Fiddler_Utilities_RecoverMemory, "Fiddler_Utilities_RecoverMemory");
        get_addr(Fiddler_WebSocketMessage_ID, "Fiddler_WebSocketMessage_ID");
        get_addr(Fiddler_WebSocketMessage_Abort, "Fiddler_WebSocketMessage_Abort");
        get_addr(Fiddler_WebSocketMessage_IsOutbound, "Fiddler_WebSocketMessage_IsOutbound");
        get_addr(Fiddler_WebSocketMessage_IsFinalFrame, "Fiddler_WebSocketMessage_IsFinalFrame");
        get_addr(Fiddler_WebSocketMessage_FrameType, "Fiddler_WebSocketMessage_FrameType");
        get_addr(Fiddler_WebSocketMessage_Get_PayloadString, "Fiddler_WebSocketMessage_Get_PayloadString");
        get_addr(Fiddler_WebSocketMessage_Set_PayloadString, "Fiddler_WebSocketMessage_Set_PayloadString");
        get_addr(Fiddler_WebSocketMessage_Get_Payload, "Fiddler_WebSocketMessage_Get_Payload");
        get_addr(Fiddler_WebSocketMessage_Set_Payload, "Fiddler_WebSocketMessage_Set_Payload");
        get_addr(Fiddler_WebSocket_IsOpen, "Fiddler_WebSocket_IsOpen");
        get_addr(WrapManage_Get_CurrentWrapStrEncoding, "WrapManage_Get_CurrentWrapStrEncoding");
        get_addr(WrapManage_Set_CurrentWrapStrEncoding, "WrapManage_Set_CurrentWrapStrEncoding");
        get_addr(WrapManage_Set_StringAlloc, "WrapManage_Set_StringAlloc");
        get_addr(WrapManage_Set_BytesAlloc, "WrapManage_Set_BytesAlloc");
        get_addr(Marshal_Alloc, "Marshal_Alloc");
        get_addr(Marshal_Free, "Marshal_Free");
#ifdef ENABLE_FIDDLERCWRAP_EXTEND
        get_addr(Fiddler_Application_Attach_AfterWebSocketCreateComplete, "Fiddler_Application_Attach_AfterWebSocketCreateComplete");
        get_addr(Fiddler_Application_Attach_AfterWebSocketCloseComplete, "Fiddler_Application_Attach_AfterWebSocketCloseComplete");
        get_addr(Fiddler_WebSocketManage_Del, "Fiddler_WebSocketManage_Del");
        get_addr(Fiddler_WebSocketManage_New, "Fiddler_WebSocketManage_New");
        get_addr(Fiddler_WebSocketManage_RemoveAllClosed, "Fiddler_WebSocketManage_RemoveAllClosed");
        get_addr(Fiddler_WebSocketManage_SendClientTextMessage, "Fiddler_WebSocketManage_SendClientTextMessage");
        get_addr(Fiddler_WebSocketManage_SendClientBinaryMessage, "Fiddler_WebSocketManage_SendClientBinaryMessage");
        get_addr(Fiddler_WebSocketManage_SendServerTextMessage, "Fiddler_WebSocketManage_SendServerTextMessage");
        get_addr(Fiddler_WebSocketManage_SendServerBinaryMessage, "Fiddler_WebSocketManage_SendServerBinaryMessage");
        get_addr(Fiddler_WebSocket_SendClientTextMessage, "Fiddler_WebSocket_SendClientTextMessage");
        get_addr(Fiddler_WebSocket_SendClientBinaryMessage, "Fiddler_WebSocket_SendClientBinaryMessage");
        get_addr(Fiddler_WebSocket_SendServerTextMessage, "Fiddler_WebSocket_SendServerTextMessage");
        get_addr(Fiddler_WebSocket_SendServerBinaryMessage, "Fiddler_WebSocket_SendServerBinaryMessage");
#endif //ENABLE_FIDDLERCWRAP_EXTEND
    }
    static void dll_free() {
        if (dll_handle_moudle)
            FreeLibrary(dll_handle_moudle);
    }
};
